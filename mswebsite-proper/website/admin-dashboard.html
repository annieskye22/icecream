<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Dashboard - Mixit Smoothies</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body { 
      font-family: 'Arial', sans-serif; 
      background: linear-gradient(135deg, #ff4d6d, #cd9452);
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
    }

    .header {
      background: rgba(255, 255, 255, 0.95);
      padding: 20px 30px;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      margin-bottom: 30px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .logo {
      font-size: 2rem;
      font-weight: bold;
      color: #ff4d6d;
    }

    .admin-info {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .logout-btn {
      background: #dc3545;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
    }

    .logout-btn:hover {
      background: #c82333;
    }

    .login-section {
      background: rgba(255, 255, 255, 0.95);
      padding: 40px;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      max-width: 500px;
      margin: 0 auto;
      text-align: center;
    }

    .dashboard-section {
      background: rgba(255, 255, 255, 0.95);
      padding: 30px;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
    }

    .login-section h2 {
      color: #333;
      margin-bottom: 30px;
      font-size: 2.5rem;
    }

    .form-group {
      margin-bottom: 20px;
      text-align: left;
    }

    .form-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: bold;
      color: #333;
    }

    .form-group input {
      width: 100%;
      padding: 12px;
      border: 2px solid #ddd;
      border-radius: 8px;
      font-size: 16px;
      transition: border-color 0.3s ease;
    }

    .form-group input:focus {
      outline: none;
      border-color: #ff4d6d;
    }

    .btn {
      background: #ff4d6d;
      color: white;
      padding: 15px 30px;
      border: none;
      border-radius: 25px;
      cursor: pointer;
      font-size: 18px;
      font-weight: bold;
      transition: all 0.3s ease;
      width: 100%;
    }

    .btn:hover {
      background: #ff6b35;
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    .stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .stat-card {
      background: #fff;
      padding: 25px;
      border-radius: 10px;
      text-align: center;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }

    .stat-card h3 {
      font-size: 2rem;
      color: #ff4d6d;
      margin-bottom: 10px;
    }

    .stat-card p {
      color: #666;
      font-size: 14px;
    }

    .controls {
      display: flex;
      gap: 15px;
      margin-bottom: 25px;
      flex-wrap: wrap;
      align-items: center;
    }

    .control-btn {
      background: #28a745;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .control-btn:hover {
      background: #218838;
    }

    .filter-select {
      padding: 10px;
      border: 2px solid #ddd;
      border-radius: 8px;
      font-size: 14px;
    }

    .orders-table {
      width: 100%;
      border-collapse: collapse;
      background: white;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }

    .orders-table th,
    .orders-table td {
      padding: 15px 12px;
      text-align: left;
      border-bottom: 1px solid #eee;
    }

    .orders-table th {
      background: #f8f9fa;
      font-weight: bold;
      color: #333;
      font-size: 14px;
      text-transform: uppercase;
    }

    .orders-table td {
      font-size: 14px;
    }

    .orders-table tr:hover {
      background: #f8f9fa;
    }

    .status-btn {
      padding: 6px 12px;
      margin: 2px;
      border: none;
      border-radius: 15px;
      cursor: pointer;
      font-size: 11px;
      font-weight: bold;
      transition: all 0.2s ease;
    }

    .status-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
    }

    .status-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    .status-pending { background: #ffc107; color: #000; }
    .status-confirmed { background: #17a2b8; color: #fff; }
    .status-preparing { background: #fd7e14; color: #fff; }
    .status-ready { background: #28a745; color: #fff; }
    .status-completed { background: #6f42c1; color: #fff; }
    .status-cancelled { background: #dc3545; color: #fff; }

    .order-id {
      font-family: monospace;
      font-weight: bold;
      color: #ff4d6d;
    }

    .customer-info {
      font-weight: 500;
    }

    .items-cell {
      max-width: 200px;
      font-size: 12px;
      line-height: 1.4;
    }

    .total-price {
      font-weight: bold;
      color: #28a745;
      font-size: 16px;
    }

    .timestamp {
      color: #666;
      font-size: 12px;
    }

    .alert {
      padding: 15px 20px;
      border-radius: 8px;
      margin-bottom: 20px;
      font-weight: bold;
      display: none;
    }

    .alert-success {
      background: #d4edda;
      color: #155724;
      border-left: 4px solid #28a745;
    }

    .alert-error {
      background: #f8d7da;
      color: #721c24;
      border-left: 4px solid #dc3545;
    }

    .alert-info {
      background: #d1ecf1;
      color: #0c5460;
      border-left: 4px solid #17a2b8;
    }

    .no-orders {
      text-align: center;
      padding: 50px;
      color: #666;
      font-size: 18px;
    }

    .hidden { display: none; }

    @media (max-width: 768px) {
      .container { padding: 10px; }
      
      .orders-table {
        font-size: 12px;
      }
      
      .orders-table th,
      .orders-table td {
        padding: 8px 6px;
      }
      
      .controls {
        flex-direction: column;
        align-items: stretch;
      }
      
      .stat-card h3 {
        font-size: 1.5rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Header -->
    <div class="header">
      <div class="logo">
        <i class="fas fa-blender"></i> <i class="fas fa-seedling"></i> Mixit Smoothies Admin
      </div>
      <div class="admin-info hidden" id="adminInfo">
        <span>Welcome, Admin</span>
        <button class="logout-btn" onclick="logout()">
          <i class="fas fa-sign-out-alt"></i> Logout
        </button>
      </div>
    </div>

    <!-- Login Section -->
    <div id="loginSection" class="login-section">
      <h2><i class="fas fa-lock"></i> Admin Login</h2>
      <div class="alert alert-error" id="loginError"></div>
      
      <form onsubmit="login(event)">
        <div class="form-group">
          <label for="email">Email Address</label>
          <input type="email" id="email" placeholder="admin@mixitsmoothies.com" required>
        </div>
        
        <div class="form-group">
          <label for="password">Password</label>
          <input type="password" id="password" placeholder="Enter your password" required>
        </div>
        
        <button type="submit" class="btn">
          <i class="fas fa-sign-in-alt"></i> Login to Dashboard
        </button>
      </form>
      
      <div style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px; font-size: 14px; color: #666;">
        <strong>Demo Credentials:</strong><br>
        Email: admin@mixitsmoothies.com<br>
        Password: mixit2024
      </div>
    </div>

    <!-- Dashboard Section -->
    <div id="dashboardSection" class="dashboard-section hidden">
      <!-- Alerts -->
      <div class="alert alert-success" id="successAlert"></div>
      <div class="alert alert-error" id="errorAlert"></div>
      <div class="alert alert-info" id="infoAlert"></div>

      <!-- Statistics -->
      <div class="stats">
        <div class="stat-card">
          <h3 id="totalOrders">0</h3>
          <p>Total Orders</p>
        </div>
        <div class="stat-card">
          <h3 id="pendingOrders">0</h3>
          <p>Pending Orders</p>
        </div>
        <div class="stat-card">
          <h3 id="completedOrders">0</h3>
          <p>Completed Orders</p>
        </div>
        <div class="stat-card">
          <h3 id="totalRevenue">â‚¦0</h3>
          <p>Total Revenue</p>
        </div>
      </div>

      <!-- Controls -->
      <div class="controls">
        <button class="control-btn" onclick="refreshOrders()">
          <i class="fas fa-sync-alt"></i> Refresh Orders
        </button>
        <button class="control-btn" onclick="exportOrders()" id="exportBtn">
          <i class="fas fa-download"></i> Export CSV
        </button>
        <select class="filter-select" id="statusFilter" onchange="filterOrders()">
          <option value="">All Status</option>
          <option value="pending">Pending</option>
          <option value="confirmed">Confirmed</option>
          <option value="preparing">Preparing</option>
          <option value="ready">Ready</option>
          <option value="completed">Completed</option>
          <option value="cancelled">Cancelled</option>
        </select>
        <input type="date" class="filter-select" id="dateFilter" onchange="filterOrders()">
      </div>

      <!-- Orders Table -->
      <div style="overflow-x: auto;">
        <table class="orders-table" id="ordersTable">
          <thead>
            <tr>
              <th>Order ID</th>
              <th>Customer</th>
              <th>Items</th>
              <th>Total</th>
              <th>Status</th>
              <th>Date & Time</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="ordersTableBody">
            <!-- Orders will be populated here -->
          </tbody>
        </table>
      </div>

      <div id="noOrders" class="no-orders hidden">
        <i class="fas fa-inbox" style="font-size: 4rem; color: #ccc; margin-bottom: 20px;"></i><br>
        No orders found. Orders will appear here when customers place them.
      </div>
    </div>
  </div>

  <script>
    // Admin credentials (in real app, this would be server-side)
    const ADMIN_CREDENTIALS = {
      email: 'admin@mixitsmoothies.com',
      password: 'mixit2024'
    };

    let isLoggedIn = false;
    let orders = [];
    let filteredOrders = [];

    // Initialize app
    document.addEventListener('DOMContentLoaded', function() {
      loadOrders();
      
      // Set today's date as default filter
      document.getElementById('dateFilter').value = new Date().toISOString().split('T')[0];
    });

    // Login function
    function login(event) {
      event.preventDefault();
      
      const email = document.getElementById('email').value.trim();
      const password = document.getElementById('password').value.trim();
      
      if (email === ADMIN_CREDENTIALS.email && password === ADMIN_CREDENTIALS.password) {
        isLoggedIn = true;
        document.getElementById('loginSection').classList.add('hidden');
        document.getElementById('dashboardSection').classList.remove('hidden');
        document.getElementById('adminInfo').classList.remove('hidden');
        
        loadOrders();
        showAlert('Welcome back, Admin! Dashboard loaded successfully.', 'success');
      } else {
        showLoginError('Invalid email or password. Please try again.');
      }
    }

    // Logout function
    function logout() {
      isLoggedIn = false;
      document.getElementById('loginSection').classList.remove('hidden');
      document.getElementById('dashboardSection').classList.add('hidden');
      document.getElementById('adminInfo').classList.add('hidden');
      
      // Clear form
      document.getElementById('email').value = '';
      document.getElementById('password').value = '';
    }

    // Load orders from localStorage
    function loadOrders() {
      try {
        orders = JSON.parse(localStorage.getItem('mixitOrders')) || [];
        filteredOrders = [...orders];
        updateStatistics();
        renderOrders();
        updateExportButton();
      } catch (error) {
        console.error('Error loading orders:', error);
        showAlert('Error loading orders from storage', 'error');
      }
    }

    // Refresh orders
    function refreshOrders() {
      loadOrders();
      showAlert('Orders refreshed successfully!', 'info');
    }

    // Update statistics
    function updateStatistics() {
      const total = orders.length;
      const pending = orders.filter(o => o.status.toLowerCase() === 'pending').length;
      const completed = orders.filter(o => o.status.toLowerCase() === 'completed').length;
      const revenue = orders
        .filter(o => o.status.toLowerCase() === 'completed')
        .reduce((sum, o) => sum + (o.totalPrice || 0), 0);

      document.getElementById('totalOrders').textContent = total;
      document.getElementById('pendingOrders').textContent = pending;
      document.getElementById('completedOrders').textContent = completed;
      document.getElementById('totalRevenue').textContent = `â‚¦${revenue.toLocaleString()}`;
    }

    // Render orders table
    function renderOrders() {
      const tbody = document.getElementById('ordersTableBody');
      const noOrdersDiv = document.getElementById('noOrders');
      
      if (filteredOrders.length === 0) {
        tbody.innerHTML = '';
        noOrdersDiv.classList.remove('hidden');
        return;
      }
      
      noOrdersDiv.classList.add('hidden');
      
      // Sort orders by timestamp (newest first)
      const sortedOrders = [...filteredOrders].sort((a, b) => 
        new Date(b.timestamp) - new Date(a.timestamp)
      );
      
      tbody.innerHTML = sortedOrders.map(order => {
        const itemsHtml = order.items.map(item => 
          `<div>${item.smoothie} x${item.qty}</div>`
        ).join('');
        
        const itemsPreview = order.items.map(item => 
          `${item.smoothie} x${item.qty}`
        ).join(', ');
        
        const displayItems = itemsPreview.length > 50 ? 
          itemsPreview.substring(0, 50) + '...' : itemsPreview;

        return `
          <tr>
            <td>
              <div class="order-id">${order.id}</div>
            </td>
            <td>
              <div class="customer-info">${order.customerName}</div>
            </td>
            <td>
              <div class="items-cell" title="${itemsPreview}">
                ${displayItems}
              </div>
            </td>
            <td>
              <div class="total-price">â‚¦${(order.totalPrice || 0).toLocaleString()}</div>
            </td>
            <td>
              <span class="status-btn status-${order.status.toLowerCase()}">
                ${order.status.toUpperCase()}
              </span>
            </td>
            <td>
              <div>${order.date || 'N/A'}</div>
              <div class="timestamp">${order.time || 'N/A'}</div>
            </td>
            <td>
              ${generateActionButtons(order)}
            </td>
          </tr>
        `;
      }).join('');
    }

    // Generate action buttons based on current status
    function generateActionButtons(order) {
      const currentStatus = order.status.toLowerCase();
      const statuses = ['confirmed', 'preparing', 'ready', 'completed'];
      
      let buttons = statuses.map(status => {
        const isDisabled = currentStatus === status || 
                          (currentStatus === 'completed' && status !== 'completed') ||
                          (currentStatus === 'cancelled');
        
        return `
          <button 
            class="status-btn status-${status}" 
            onclick="updateOrderStatus('${order.id}', '${status}')"
            ${isDisabled ? 'disabled' : ''}
          >
            ${status.charAt(0).toUpperCase() + status.slice(1)}
          </button>
        `;
      }).join(' ');

      // Add cancel button if not already completed or cancelled
      if (currentStatus !== 'completed' && currentStatus !== 'cancelled') {
        buttons += `
          <br>
          <button 
            class="status-btn status-cancelled" 
            onclick="updateOrderStatus('${order.id}', 'cancelled')"
            style="margin-top: 5px;"
          >
            Cancel
          </button>
        `;
      }

      return buttons;
    }

    // Update order status
    function updateOrderStatus(orderId, newStatus) {
      const orderIndex = orders.findIndex(order => order.id === orderId);
      if (orderIndex === -1) {
        showAlert('Order not found!', 'error');
        return;
      }

      const oldStatus = orders[orderIndex].status;
      orders[orderIndex].status = newStatus;
      orders[orderIndex].lastUpdated = new Date().toISOString();
      
      // Save to localStorage
      localStorage.setItem('mixitOrders', JSON.stringify(orders));
      
      // Refresh display
      loadOrders();
      filterOrders(); // Apply current filters
      
      showAlert(
        `Order ${orderId} status updated from ${oldStatus.toUpperCase()} to ${newStatus.toUpperCase()}!`, 
        'success'
      );
    }

    // Filter orders
    function filterOrders() {
      const statusFilter = document.getElementById('statusFilter').value.toLowerCase();
      const dateFilter = document.getElementById('dateFilter').value;
      
      filteredOrders = orders.filter(order => {
        const matchesStatus = !statusFilter || order.status.toLowerCase() === statusFilter;
        
        let matchesDate = true;
        if (dateFilter) {
          const orderDate = new Date(order.timestamp).toISOString().split('T')[0];
          matchesDate = orderDate === dateFilter;
        }
        
        return matchesStatus && matchesDate;
      });
      
      renderOrders();
    }

    // Export orders to CSV
    function exportOrders() {
      if (orders.length === 0) {
        showAlert('No orders to export!', 'error');
        return;
      }
      
      const headers = [
        'Order ID', 'Customer Name', 'Items', 'Total Price (â‚¦)', 
        'Status', 'Date', 'Time', 'Timestamp'
      ];
      
      const csvData = orders.map(order => {
        const items = order.items.map(item => 
          `${item.smoothie} x${item.qty} (â‚¦${(item.price * item.qty).toLocaleString()})`
        ).join('; ');
        
        return [
          order.id,
          `"${order.customerName}"`,
          `"${items}"`,
          order.totalPrice || 0,
          order.status,
          order.date || '',
          order.time || '',
          order.timestamp || ''
        ].join(',');
      });
      
      const csv = [headers.join(','), ...csvData].join('\n');
      
      const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
      const link = document.createElement('a');
      const url = URL.createObjectURL(blob);
      
      link.setAttribute('href', url);
      link.setAttribute('download', `mixit-orders-${new Date().toISOString().split('T')[0]}.csv`);
      link.style.visibility = 'hidden';
      
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      
      showAlert('Orders exported successfully!', 'success');
    }

    // Update export button state
    function updateExportButton() {
      const exportBtn = document.getElementById('exportBtn');
      if (orders.length === 0) {
        exportBtn.disabled = true;
        exportBtn.style.opacity = '0.5';
      } else {
        exportBtn.disabled = false;
        exportBtn.style.opacity = '1';
      }
    }

    // Show alerts
    function showAlert(message, type) {
      const alertId = type + 'Alert';
      const alertElement = document.getElementById(alertId);
      
      // Hide all alerts first
      document.querySelectorAll('.alert').forEach(alert => {
        alert.style.display = 'none';
      });
      
      // Show the specific alert
      alertElement.textContent = message;
      alertElement.style.display = 'block';
      
      // Auto-hide after 5 seconds
      setTimeout(() => {
        alertElement.style.display = 'none';
      }, 5000);
    }

    // Show login error
    function showLoginError(message) {
      const errorAlert = document.getElementById('loginError');
      errorAlert.textContent = message;
      errorAlert.style.display = 'block';
      
      setTimeout(() => {
        errorAlert.style.display = 'none';
      }, 5000);
    }

    // Auto-refresh orders every 30 seconds when logged in
    setInterval(() => {
      if (isLoggedIn) {
        loadOrders();
      }
    }, 30000);

    // Keyboard shortcuts
    document.addEventListener('keydown', function(e) {
      if (!isLoggedIn) return;
      
      // Ctrl+R to refresh
      if (e.ctrlKey && e.key === 'r') {
        e.preventDefault();
        refreshOrders();
      }
      
      // Ctrl+E to export
      if (e.ctrlKey && e.key === 'e') {
        e.preventDefault();
        exportOrders();
      }
    });

    console.log('ðŸ”§ Mixit Smoothies Admin Dashboard Initialized');
    console.log('ðŸ“Š Features: Order Management, Status Updates, Export, Real-time Stats');
    console.log('ðŸ”‘ Login: admin@mixitsmoothies.com / mixit2024');
  </script>
</body>
</html>